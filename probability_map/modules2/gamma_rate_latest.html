<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Gamma(α, λ) — Minimal Interactive Page</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <style>
    :root{ --bg:#f5f7f9; --panel:#ffffff; --ink:#111; --muted:#555; --border:#dcdcdc; --accent:#0ea5e9; }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0; font:15px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Arial; color:var(--ink); background:var(--bg)}
    header{padding:10px 18px; background:#6b7280; color:#fff; font-weight:600}
    .wrap{max-width:1100px; margin:14px auto; padding:0 14px; display:grid; grid-template-columns: 360px 1fr; gap:14px}
    .card{background:var(--panel); border:1px solid var(--border); border-radius:12px; padding:12px}
    .row{display:flex; align-items:center; gap:10px; margin:6px 0}
    label{min-width:22px; color:#333; font-weight:600}
    input[type="number"], input[type="range"]{padding:6px 8px; border:1px solid var(--border); border-radius:8px}
    input[type="number"]{width:100px}
    input[type="range"]{width:200px}
    .kblock{background:#fff; border:1px solid var(--border); border-radius:10px; padding:10px; margin-top:10px}
    .note{color:var(--muted); font-size:13px}
    .plot{background:#fff; border:1px solid var(--border); border-radius:12px; padding:10px}
    .plot h3{margin:0 0 6px 0; font-size:14px}
    canvas{width:100%; height:280px; display:block; background:#fafafa; border-radius:8px}
    @media (max-width: 900px){ .wrap{grid-template-columns: 1fr} }
  </style>
</head>
<body>
<header>Gamma(α, λ) — rate parameterization</header>
<main class="wrap">
  <section class="card">
    <div class="row">
      <label for="alpha">α</label>
      <input id="alpha" type="range" min="0.5" max="10" step="0.5" value="3">
      <input id="alphaNum" type="number" min="0.1" step="0.1" value="3">
      <span class="note">(shape)</span>
    </div>
    <div class="row">
      <label for="rate">λ</label>
      <input id="rate" type="range" min="0.2" max="5" step="0.1" value="1">
      <input id="rateNum" type="number" min="0.01" step="0.1" value="1">
      <span class="note">(rate = 1/scale)</span>
    </div>
    <div class="kblock">
      <div class="note">Key facts</div>
      <ul class="note" style="margin:6px 0 0 18px">
        <li>Support: x ≥ 0</li>
        <li>PDF: f(x) = λ<sup>α</sup>/Γ(α) · x<sup>α−1</sup> e<sup>−λx</sup></li>
        <li>Mean: E[X] = α/λ</li>
        <li>Variance: Var[X] = α/λ²</li>
        <li>Relation: For integer α=k, sum of k i.i.d. Exponential(λ)</li>
      </ul>
    </div>
    <div class="kblock">
      <div class="note">Parameters</div>
      <div class="note">α = <span id="alphaOut">3</span>, λ = <span id="rateOut">1.00</span>,  E[X] = <span id="meanOut">3.00</span>, Var[X] = <span id="varOut">3.00</span></div>
    </div>
  </section>

  <section class="card">
    <div class="plot">
      <h3>PDF</h3>
      <canvas id="pdf"></canvas>
    </div>
  </section>
</main>

<script>
const alphaSlider = document.getElementById('alpha');
const alphaNum = document.getElementById('alphaNum');
const rateSlider = document.getElementById('rate');
const rateNum = document.getElementById('rateNum');
const alphaOut = document.getElementById('alphaOut');
const rateOut = document.getElementById('rateOut');
const meanOut = document.getElementById('meanOut');
const varOut = document.getElementById('varOut');
const pdfCanvas = document.getElementById('pdf');

function setupCanvas(canvas){
  const dpr = window.devicePixelRatio || 1;
  const rect = canvas.getBoundingClientRect();
  canvas.width = Math.round(rect.width * dpr);
  canvas.height = Math.round(rect.height * dpr);
  const ctx = canvas.getContext('2d');
  ctx.scale(dpr, dpr);
  return ctx;
}
// Lanczos gamma approximation
function gammafn(z){
  const g = 7;
  const p = [0.99999999999980993, 676.5203681218851, -1259.1392167224028,
    771.32342877765313, -176.61502916214059, 12.507343278686905,
    -0.13857109526572012, 9.9843695780195716e-6, 1.5056327351493116e-7];
  if(z < 0.5){
    return Math.PI / (Math.sin(Math.PI*z) * gammafn(1 - z));
  } else {
    z -= 1;
    let x = p[0];
    for (let i = 1; i < p.length; i++) x += p[i] / (z + i);
    const t = z + g + 0.5;
    return Math.sqrt(2*Math.PI) * Math.pow(t, z + 0.5) * Math.exp(-t) * x;
  }
}
function gammaPdf(x, a, l){
  if(x <= 0) return 0;
  const c = Math.pow(l, a) / gammafn(a);
  return c * Math.pow(x, a-1) * Math.exp(-l*x);
}
function drawAxes(ctx,w,h){
  ctx.strokeStyle = '#e6e6e6'; ctx.lineWidth = 1;
  ctx.beginPath(); ctx.moveTo(40,h-24); ctx.lineTo(w-10,h-24); ctx.stroke();
  ctx.beginPath(); ctx.moveTo(40,10); ctx.lineTo(40,h-10); ctx.stroke();
}
function drawPDF(a,l){
  const ctx = setupCanvas(pdfCanvas);
  const rect = pdfCanvas.getBoundingClientRect(), w=rect.width, h=rect.height;
  ctx.clearRect(0,0,w,h);
  drawAxes(ctx,w,h);
  const mean = a/l, sd = Math.sqrt(a)/l;
  const xmin = 0, xmax = Math.max(8, mean + 5*sd);
  const N = Math.max(300, Math.floor(w));
  const L=50,R=10,T=10,B=24, plotW=w-L-R, plotH=h-T-B;
  // find ymax by sampling
  let ymax = 0;
  for(let i=0;i<N;i++){ const x=xmin+(xmax-xmin)*i/(N-1); const y=gammaPdf(x,a,l); if(y>ymax) ymax=y; }
  ymax = ymax*1.1 || 1;
  function toXY(x,y){ const tx=L+(x-xmin)*plotW/(xmax-xmin); const ty=(h-B)-y*plotH/ymax; return [tx,ty]; }
  ctx.strokeStyle='#0ea5e9'; ctx.lineWidth=2; ctx.beginPath();
  let [x0,y0] = toXY(0, gammaPdf(0.0001,a,l)); ctx.moveTo(x0,y0);
  for(let i=1;i<N;i++){ const x=xmin+(xmax-xmin)*i/(N-1); const y=gammaPdf(x,a,l); const [xi,yi]=toXY(x,y); ctx.lineTo(xi,yi); }
  ctx.stroke();
  ctx.fillStyle='#777'; ctx.font='12px system-ui, sans-serif';
  const k=5; for(let j=0;j<=k;j++){ const x=xmin+j*(xmax-xmin)/k; const [tx,ty]=toXY(x,0); ctx.fillText(x.toFixed(1), tx-10, h-6); }
}

function sync(){
  let a = Math.max(0.05, parseFloat(alphaSlider.value)||3);
  let l = Math.max(0.0001, parseFloat(rateSlider.value)||1);
  alphaNum.value = a; rateNum.value = l;
  alphaOut.textContent = a.toString();
  rateOut.textContent = l.toFixed(2);
  meanOut.textContent = (a/l).toFixed(2);
  varOut.textContent = (a/(l*l)).toFixed(2);
  drawPDF(a,l);
}
alphaSlider.addEventListener('input', sync);
alphaNum.addEventListener('input', (e)=>{ alphaSlider.value = e.target.value; sync(); });
rateSlider.addEventListener('input', sync);
rateNum.addEventListener('input', (e)=>{ rateSlider.value = e.target.value; sync(); });
window.addEventListener('resize', sync);
sync();
</script>
</body>
</html>
